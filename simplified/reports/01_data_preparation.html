<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Notebook
  </title>
  <link href="https://ghcdn.rawgit.org/henriquebferreira/faceit-predictor-ML/master/src/notebooks/style.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
  </script>
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe">
  </script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
  </script>
  <!-- End of mathjax configuration -->
 </head>
 <body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h1 style="color:#ff5500; font-family:Play; font-size:3em; margin:auto 32px;align:center">
     Part I - Data Preparation
    </h1>
    <hr/>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <p>
     This document is a part of the FACEIT Predictor Data Science Workflow.
    </p>
    <p>
     In this notebook the collected data (stored in the local MongoDB database) is processed in order to create a dataset.
    </p>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h1 id="Imports">
     Imports
     <a class="anchor-link" href="#Imports">
      ¶
     </a>
    </h1>
   </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
   <div class="jp-Cell-inputWrapper">
    <div class="jp-InputArea jp-Cell-inputArea">
     <div class="jp-InputPrompt jp-InputArea-prompt">
      In [5]:
     </div>
     <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
      <div class="CodeMirror cm-s-jupyter">
       <div class="highlight hl-ipython3">
        <pre><span></span><span class="c1"># enable imports from parent directory</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>

<span class="c1"># local modules</span>
<span class="kn">from</span> <span class="nn">src.utils.dirs</span> <span class="kn">import</span> <span class="n">INTERIM_DATA_DIR_S</span><span class="p">,</span> <span class="n">EXTERNAL_DATA_DIR_S</span><span class="p">,</span> <span class="n">RAW_DATA_DIR_S</span>
<span class="kn">from</span> <span class="nn">src.data.processable_matches</span> <span class="kn">import</span> <span class="n">processable_matches_simple</span>
<span class="kn">from</span> <span class="nn">src.data.build_raw_dataset</span> <span class="kn">import</span> <span class="n">build_raw_dataset</span>
<span class="kn">from</span> <span class="nn">src.data.build_interim_dataset</span> <span class="kn">import</span> <span class="n">build_interim_dataset</span>

<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>

<span class="n">ipython</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>

<span class="c1"># autoreload extension</span>
<span class="k">if</span> <span class="s2">"autoreload"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ipython</span><span class="o">.</span><span class="n">extension_manager</span><span class="o">.</span><span class="n">loaded</span><span class="p">:</span>
   <span class="o">%</span><span class="k">load_ext</span> autoreload

<span class="c1"># autoreload python modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h1 id="Get-Complete-&amp;-Processable-Matches">
     Get Complete &amp; Processable Matches
     <a class="anchor-link" href="#Get-Complete-&amp;-Processable-Matches">
      ¶
     </a>
    </h1>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <p>
     Even though there are more than one million matches stored in DB, not all are qualified to be part of the dataset.
    </p>
    <p>
     A valid processable match should have complete player data for every participant. This includes the lifetime stats before the beginning of the match.
    </p>
    <ul>
     <li>
      <code>
       lifetime_stats
      </code>
      : the lifetime stats of the player regarding the match are available
     </li>
    </ul>
    <p>
     The
     <code>
      lifetime_stats
     </code>
     are initially set to 0 and incremented each time the conditions are met for one player.
    </p>
    <p>
     Finally the match ids are filtered to include only those who have full data for all ten players.
    </p>
   </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
   <div class="jp-Cell-inputWrapper">
    <div class="jp-InputArea jp-Cell-inputArea">
     <div class="jp-InputPrompt jp-InputArea-prompt">
      In [ ]:
     </div>
     <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
      <div class="CodeMirror cm-s-jupyter">
       <div class="highlight hl-ipython3">
        <pre><span></span><span class="n">processable_matches_simple</span><span class="p">()</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h1 id="Build-Dataset">
     Build Dataset
     <a class="anchor-link" href="#Build-Dataset">
      ¶
     </a>
    </h1>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <p>
     Dataset stored in batch files of size 2000. The format chosen is CSV.
    </p>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h2 id="Raw-Dataset">
     Raw Dataset
     <a class="anchor-link" href="#Raw-Dataset">
      ¶
     </a>
    </h2>
   </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
   <div class="jp-Cell-inputWrapper">
    <div class="jp-InputArea jp-Cell-inputArea">
     <div class="jp-InputPrompt jp-InputArea-prompt">
      In [ ]:
     </div>
     <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
      <div class="CodeMirror cm-s-jupyter">
       <div class="highlight hl-ipython3">
        <pre><span></span><span class="n">build_raw_dataset</span><span class="p">(</span><span class="n">RAW_DATA_DIR_S</span><span class="p">,</span> <span class="n">EXTERNAL_DATA_DIR_S</span><span class="p">)</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <h2 id="Interim-Dataset">
     Interim Dataset
     <a class="anchor-link" href="#Interim-Dataset">
      ¶
     </a>
    </h2>
   </div>
  </div>
  <div class="jp-Cell-inputWrapper">
   <div class="jp-InputPrompt jp-InputArea-prompt">
   </div>
   <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
    <p>
     Iterate over matches and for each player get the lifetime stats before the beginning of the match.
    </p>
    <p>
     Store the data of every player on each element of the teamA and teamB lists.
    </p>
   </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
   <div class="jp-Cell-inputWrapper">
    <div class="jp-InputArea jp-Cell-inputArea">
     <div class="jp-InputPrompt jp-InputArea-prompt">
      In [ ]:
     </div>
     <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
      <div class="CodeMirror cm-s-jupyter">
       <div class="highlight hl-ipython3">
        <pre><span></span><span class="n">build_interim_dataset</span><span class="p">(</span><span class="n">INTERIM_DATA_DIR_S</span><span class="p">,</span> <span class="n">EXTERNAL_DATA_DIR_S</span><span class="p">,</span> <span class="n">is_complete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
